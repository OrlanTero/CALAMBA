<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Registration</title>
    <!-- Include Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #ebeeee;
        /*background: linear-gradient(to right, #74ebd5, #acb6e5);*/
      }

      .intro {
        width: 100%;
        max-width: 500px !important;
        height: 100px;
        background: #fff;
        /*background-color: #143213;*/
        display: flex;
        justify-content: start;
        align-items: center;
        border-radius: 4px;
        margin-bottom: 10px;
        padding: 0 20px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
        color: #050505
      }

      .intro .text {
        margin-left: -30px !important;
      }

      .intro .primary {
        font-size: 24px;
      }

      .intro .secondary {
        font-size: 14px;
      }

      .container {
        width: 100%;
        max-width: 500px;
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
        padding: 40px 30px;
        transition: transform 0.3s;
      }

      h2 {
        color: #2980b9;
        margin-bottom: 20px;
        text-align: center;
        font-size: 28px;
      }

      .form-group label {
        font-weight: bold;
        text-align: left !important;
        padding: 5px 0;
        font-size: 14px;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        transition: border-color 0.3s;
      }

      .form-group input:focus,
      .form-group select:focus {
        border-color: #2980b9;
        outline: none;
      }

      .user-type {
        text-align: center;
        margin: 20px 0;
      }

      input[type="submit"] {
        background-color: #2980b9;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 12px 40px;
        cursor: pointer;
        display: block;
        margin: 10px auto 0;
        font-size: 16px;
        transition: background-color 0.3s;
      }

      input[type="submit"]:hover {
        background-color: #2471a3;
      }

      .selection-user-type-card {
        display: flex;
        align-items: center;
        /*padding: 10px;*/
      }

      .selection-card {
        width: 250px;
        height: 50px;
        border-radius: 4px;
        background: #fff;
        border: 1px solid #EBEEEE;
        margin: 0 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        user-select: none;
        color: #050505;
      }

      .selection-card.active {
        /*background-color: #2471a3;*/
        /*color: #fff;*/
        border: 1px solid #2471a3;
        color: #2471a3;
      }

      .sub {
        margin-top: 30px;
      }

      .error-container.input-error input {
          border-color: red !important;
      }

      .error-container .error-message {
          color: red;
          font-size: 12px;
          margin-top: 5px;
          display: block;
          transition: opacity 0.3s;
      }
    </style>
  </head>
  <body>
    <div class="container col-10 col-md-6 col-lg-4">
      <h2>User Registration</h2>
      <form action="register.php" class="registration-form" method="post">
        <div class="form-group mb-3">
          <div class="row">
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="firstName">First Name:</label>-->
              <input
                type="text"
                id="firstName"
                name="first_name"
                class="form-control"
                placeholder="First Name"
                required
              />
            </div>
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="middleName">Middle Name:</label>-->
              <input
                type="text"
                id="middleName"
                name="middle_name"
                class="form-control"
                placeholder="Middle Name"
              />
            </div>
          </div>
        </div>

        <div class="form-group mb-3">
          <div class="row">
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="lastName">Last Name:</label>-->
              <input
                type="text"
                id="lastName"
                name="last_name"
                class="form-control"
                required
                placeholder="Last Name"
              />
            </div>
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="suffix">Suffix:</label>-->
              <input
                type="text"
                id="suffix"
                name="suffix"
                class="form-control"
                placeholder="Suffix"
              />
            </div>
          </div>
        </div>

        <div class="form-group mb-3">
          <div class="row">
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="phone">Phone Number:</label>-->
              <input type="text" id="phone" name="phone" class="form-control" placeholder="Phone"/>
            </div>
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="studentID">ID Number (username):</label>-->
              <input
                type="text"
                id="studentID"
                name="student_id"
                class="form-control"
                required
                placeholder="ID Number"
              />
            </div>
          </div>
        </div>

        <div class="form-group mb-3">
          <select id="course" name="course" class="form-control" required>
            <option value="">Select Course</option>
            <option value="RAC Servicing (DomRAC)">
              RAC Servicing (DomRAC)
            </option>
            <option value="Basic Shielded Metal Arc Welding">
              Basic Shielded Metal Arc Welding
            </option>
            <option value="Advanced Shielded Metal Arc Welding">
              Advanced Shielded Metal Arc Welding
            </option>
            <option value="PC Operation">PC Operation</option>
            <option value="Bread and Pastry Production NC II">
              Bread and Pastry Production NC II
            </option>
            <option value="Computer Aid Design (CAD)">
              Computer Aid Design (CAD)
            </option>
            <option value="Culinary Arts">Culinary Arts</option>
            <option value="Dressmaking NC II">Dressmaking NC II</option>
            <option value="Food and Beverage Service NC II">
              Food and Beverage Service NC II
            </option>
            <option value="Hair Care">Hair Care</option>
            <option value="Junior Beautician">Junior Beautician</option>
            <option value="Gas Metal Arc Welding -- GMAW NC I">
              Gas Metal Arc Welding -- GMAW NC I
            </option>
            <option value="Gas Metal Arc Welding -- GMAW NC II">
              Gas Metal Arc Welding -- GMAW NC II
            </option>
          </select>
        </div>

        <div class="form-group mb-3">
          <div class="row">
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="pword">Password:</label>-->
              <input
                type="password"
                id="pword"
                name="pword"
                class="form-control"
                required
                placeholder="Password"
              />
            </div>
            <div class="col-md-6 mb-3 error-container">
<!--              <label for="confirmPword">Confirm Password:</label>-->
              <input
                type="password"
                id="confirmPword"
                name="confirmPword"
                class="form-control"
                required
                placeholder="Confirm Password"
              />
            </div>
          </div>
        </div>

        <div class="user-type">
          <div class="selection-user-type-card">
            <div class="selection-card active" data-value="student">
              <div class="text">
                <span>Student</span>
              </div>
            </div>
            <div class="selection-card" data-value="instructor">
              <div class="text">
                <span>Instructor</span>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group mb-3 sub" >
          <input type="submit" value="Register" />
        </div>

          <div class="text-center mt-3">
              <h6 class="d-inline">Already have an account?</h6>
              <a href="/" class="register-link"><h6>Login</h6></a>
          </div>
      </form>
    </div>

    <!-- Include Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

  <script type="module">
    import {ListenToForm,SetActiveComponent,ResetActiveComponent, Ajax, ToData, GoError} from "./scripts/Tool.js";

    const form = document.querySelector(".registration-form");
    const selections = document.querySelectorAll(".selection-user-type-card .selection-card");
    let user_type = "student";

    ListenToForm(form, function (data) {
      RegisterUser({...data, user_type}).then((res)=> {
          console.log(res)
          if (res.code === 300) {
              GoError(res.body.errors, form);
          } else {
              alert("User registered successfully!");

              window.location.href = "/";
          }
      });
    })

    for( const selection of selections) {
      selection.addEventListener("click", function (e) {
        ResetActiveComponent(selections);
        SetActiveComponent(selection, true);

        user_type = selection.dataset.value;
      })
    }
    function RegisterUser(data) {
        return new Promise((resolve) => {
            Ajax({
                url: `_register.php`,
                type: "POST",
                data: ToData({ data: JSON.stringify(data) }),
                success: (res) => {
                    try {
                        resolve(JSON.parse(res));
                    } catch (e) {
                        console.error(e);
                    }
                },
            });
        })
    }


  </script>
  </body>
</html>
